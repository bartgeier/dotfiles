#include "gtest/gtest.h"
#include "XTEA.h"

TEST(XTEA, decipher) {
        std::array<uint32_t, 4> const key = { 1,2,3,4 };
        std::array<uint32_t, 2> const secret = {3349449178, 1799649188 };
        std::array<uint32_t, 2> v = decipher(secret, key);
        EXPECT_EQ(v[0], (uint32_t)1385482523);
        EXPECT_EQ(v[1], (uint32_t)639876499);
}


TEST(XTEA, decode_0) {
        /*python3 xtea.py hello*/
        std::array<uint32_t, 4> const key = { 2802116239,3661675230,1810895124,447663303 };
        std::vector<uint32_t> const secret = {
                989003193,4275926718,2335116394,3046237383,447663414,
        };
        std::string s = XTEA_decode(secret, key);
        EXPECT_EQ(s, "hello");
}

TEST(XTEA, decode_1) {
        /*python3 xtea.py ftp://ftp_noventa:Jugofalagaru29!@185.37.75.153/c1_sw-version_logs/*/
        std::array<uint32_t, 4> const key = { 2802116239,3661675230,1810895124,447663303 };
        std::vector<uint32_t> const secret = {
        1202470833,1317563876,1866570336,3773653178,3475742936,2946386687,1202470833,
        1317563876,3345138985,1343326593,352982371,4033872983,3205438494,3244042829,
        636935204,793537345,3666512921,2145866377,1469764116,1673112715,1820727634,
        2135162542,3227113460,1307873339,413020639,2496569940,1883175291,1378697438,
        3292380750,290543900,3446409922,1430037110,2312307648,3605578798,3868705318,
        2345256226,3118745900,1378435688,471987070,495561503,3818650865,2023631014,
        3118745900,1378435688,999569966,2547529801,800387954,3543596210,1198027516,
        984383469,3321081123,3781875324,3195174883,3416444205,3205438494,3244042829,
        3037802189,1091758268,1187091396,2789018395,1106509054,3530363098,4143009021,
        2229073442,1423854408,3734726188,447663350,
        };
        std::string s = XTEA_decode(secret, key);
        EXPECT_EQ(s, "ftp://ftp_noventa:Jugofalagaru29!@185.37.75.153/c1_sw-version_logs/");
}

